
import pyconll
import os
import re
import sys

def get_error_sents(path):
    error_sent_ids = []
    for file in os.listdir(path):
        conll = pyconll.iter_from_file(os.path.join(path, file))
        for sentence in conll:
            count_roots = 0
            for token in sentence:
                if token.id == token.head:
                    error_sent_ids.append(sentence.id)
                    continue
                if token.deprel == 'root' or token.head == '0':
                    # print(token.deprel)
                    count_roots += 1
            if count_roots != 1:
                if sentence.id not in error_sent_ids:
                    error_sent_ids.append(sentence.id)
    return error_sent_ids

def fix_sent_ids(conll, file_count, total_count):
    lines = conll.split('\n')
    s_id = lines[1]
    x_id = lines[0]
    new_s_id = s_id.split(',')[0]+f',{file_count}.{total_count}'
    new_lines = [new_s_id, x_id] + lines[2:]
    return '\n'.join(new_lines)

SPLITS = {
    'train': ['ALTHINGI_BO_2013_G-33-4894243.conllu', 
                'ALTHINGI_BO_2013_G-33-4927514.conllu', 
                'ALTHINGI_BO_2014_G-33-4618570.conllu', 
                'ALTHINGI_BO_2014_G-33-4627188.conllu', 
                'ALTHINGI_BO_2014_G-33-4644921.conllu',
                'ALTHINGI_BO_2014_G-33-4654837.conllu', 
                'ALTHINGI_BO_2014_G-33-4667114.conllu', 
                'ALTHINGI_BO_2014_G-33-4669345.conllu', 
                'ALTHINGI_BO_2014_G-33-4669346.conllu', 
                'ALTHINGI_BO_2014_G-33-4672886.conllu', 
                'ALTHINGI_BO_2014_G-33-4698744.conllu', 
                'ALTHINGI_BO_2014_G-33-4739932.conllu', 
                'ALTHINGI_BO_2014_G-33-4797979.conllu', 
                'ALTHINGI_BO_2014_G-33-4815303.conllu', 
                'ALTHINGI_BO_2014_G-33-4817818.conllu', 
                'ALTHINGI_BO_2014_G-33-4818844.conllu', 
                'ALTHINGI_BO_2014_G-33-4850283.conllu', 
                'ALTHINGI_BO_2014_G-33-4879443.conllu', 
                'ALTHINGI_BO_2014_G-33-4893594.conllu', 
                'ALTHINGI_BO_2014_G-33-4901583.conllu', 
                'ALTHINGI_BO_2014_G-33-4904609.conllu', 
                'ALTHINGI_BO_2014_G-33-4919596.conllu', 
                'ALTHINGI_BO_2014_G-33-4931176.conllu', 
                'ALTHINGI_BO_2014_G-33-4931970.conllu', 
                'ALTHINGI_BO_2015_G-33-4630174.conllu', 
                'ALTHINGI_BO_2015_G-33-4630175.conllu', 
                'ALTHINGI_BO_2015_G-33-4633033.conllu', 
                'ALTHINGI_BO_2015_G-33-4637296.conllu', 
                'ALTHINGI_BO_2015_G-33-4647803.conllu', 
                'ALTHINGI_BO_2015_G-33-4651739.conllu', 
                'ALTHINGI_BO_2015_G-33-4662125.conllu', 
                'ALTHINGI_BO_2015_G-33-4673392.conllu', 
                'ALTHINGI_BO_2015_G-33-4679339.conllu', 
                'ALTHINGI_BO_2015_G-33-4691247.conllu', 
                'ALTHINGI_BO_2015_G-33-4694326.conllu', 
                'ALTHINGI_BO_2015_G-33-4697916.conllu', 
                'ALTHINGI_BO_2015_G-33-4712127.conllu', 
                'ALTHINGI_BO_2015_G-33-4712649.conllu', 
                'ALTHINGI_BO_2015_G-33-4722866.conllu',
                'ALTHINGI_BO_2015_G-33-4755174.conllu', 
                'ALTHINGI_BO_2015_G-33-4758602.conllu', 
                'ALTHINGI_BO_2015_G-33-4761539.conllu', 
                'ALTHINGI_BO_2015_G-33-4765032.conllu', 
                'ALTHINGI_BO_2015_G-33-4768228.conllu', 
                'ALTHINGI_BO_2015_G-33-4786349.conllu', 
                'ALTHINGI_BO_2015_G-33-4790381.conllu', 
                'ALTHINGI_BO_2015_G-33-4821747.conllu',
                'ALTHINGI_BO_2015_G-33-4825748.conllu', 
                'ALTHINGI_BO_2015_G-33-4835966.conllu', 
                'ALTHINGI_BO_2015_G-33-4847206.conllu', 
                'ALTHINGI_BO_2015_G-33-4857988.conllu', 
                'ALTHINGI_BO_2015_G-33-4886135.conllu', 
                'ALTHINGI_BO_2015_G-33-4894126.conllu', 
                'ALTHINGI_BO_2015_G-33-4904610.conllu', 
                'ALTHINGI_BO_2015_G-33-4927424.conllu', 
                'ALTHINGI_BO_2015_G-33-4934628.conllu', 
                'ALTHINGI_HHG_2013_G-33-4584345.conllu', 
                'ALTHINGI_HHG_2013_G-33-4591478.conllu', 
                'ALTHINGI_HHG_2013_G-33-4591481.conllu', 
                'ALTHINGI_HHG_2013_G-33-4591517.conllu', 
                'ALTHINGI_HHG_2013_G-33-4598613.conllu', 
                'ALTHINGI_HHG_2013_G-33-4602100.conllu', 
                'ALTHINGI_HHG_2013_G-33-4612805.conllu', 
                'ALTHINGI_HHG_2013_G-33-4624362.conllu', 
                'ALTHINGI_HHG_2013_G-33-4627203.conllu', 
                'ALTHINGI_HHG_2013_G-33-4655508.conllu', 
                'ALTHINGI_HHG_2013_G-33-4662809.conllu', 
                'ALTHINGI_HHG_2013_G-33-4677138.conllu', 
                'ALTHINGI_HHG_2013_G-33-4690249.conllu', 
                'ALTHINGI_HHG_2013_G-33-4694996.conllu', 
                'ALTHINGI_HHG_2013_G-33-4694998.conllu', 
                'ALTHINGI_HHG_2013_G-33-4697411.conllu', 
                'ALTHINGI_HHG_2013_G-33-4702922.conllu', 
                'ALTHINGI_HHG_2013_G-33-4705680.conllu',
                'ALTHINGI_HHG_2013_G-33-4705681.conllu', 
                'ALTHINGI_HHG_2013_G-33-4705733.conllu', 
                'ALTHINGI_HHG_2013_G-33-4715181.conllu', 
'ALTHINGI_HHG_2013_G-33-4719940.conllu', 
'ALTHINGI_HHG_2013_G-33-4723481.conllu', 
'ALTHINGI_HHG_2013_G-33-4723524.conllu', 
'ALTHINGI_HHG_2013_G-33-4727073.conllu', 
'ALTHINGI_HHG_2013_G-33-4727814.conllu', 
'ALTHINGI_HHG_2013_G-33-4736504.conllu', 
'ALTHINGI_HHG_2013_G-33-4737686.conllu', 
'ALTHINGI_HHG_2013_G-33-4744792.conllu', 
'ALTHINGI_HHG_2013_G-33-4748259.conllu', 
'ALTHINGI_HHG_2013_G-33-4751826.conllu', 
'ALTHINGI_HHG_2013_G-33-4767979.conllu', 
'ALTHINGI_HHG_2013_G-33-4776350.conllu', 
'ALTHINGI_HHG_2013_G-33-4783427.conllu', 
'ALTHINGI_HHG_2013_G-33-4794202.conllu', 
'ALTHINGI_HHG_2013_G-33-4794203.conllu', 
'ALTHINGI_HHG_2013_G-33-4796704.conllu', 
'ALTHINGI_HHG_2013_G-33-4805581.conllu', 
'ALTHINGI_HHG_2013_G-33-4808308.conllu', 
'ALTHINGI_HHG_2013_G-33-4808309.conllu', 
'ALTHINGI_HHG_2013_G-33-4818860.conllu', 
'ALTHINGI_HHG_2013_G-33-4828186.conllu', 
'ALTHINGI_HHG_2013_G-33-4833012.conllu', 
'ALTHINGI_HHG_2013_G-33-4836659.conllu', 
'ALTHINGI_HHG_2013_G-33-4848116.conllu', 
'ALTHINGI_HHG_2013_G-33-4854491.conllu', 
'ALTHINGI_HHG_2013_G-33-4858130.conllu', 
'ALTHINGI_HHG_2013_G-33-4858131.conllu', 
'ALTHINGI_HHG_2013_G-33-4858182.conllu', 
'ALTHINGI_HHG_2013_G-33-4865168.conllu', 
'ALTHINGI_HHG_2013_G-33-4875869.conllu', 
'ALTHINGI_HHG_2013_G-33-4875931.conllu', 
'ALTHINGI_HHG_2013_G-33-4892260.conllu', 
'ALTHINGI_HHG_2013_G-33-4894299.conllu', 
'ALTHINGI_HHG_2013_G-33-4896728.conllu', 
'ALTHINGI_HHG_2013_G-33-4901642.conllu', 
'ALTHINGI_HHG_2013_G-33-4912891.conllu', 
'ALTHINGI_HHG_2013_G-33-4916516.conllu', 
'ALTHINGI_HHG_2013_G-33-4916517.conllu', 
'ALTHINGI_HHG_2013_G-33-4916580.conllu', 
'ALTHINGI_HHG_2013_G-33-4920264.conllu', 
'ALTHINGI_HHG_2013_G-33-4920265.conllu', 
'ALTHINGI_SJS_2013_G-33-4524841.conllu', 
'ALTHINGI_SJS_2013_G-33-4528340.conllu', 
'ALTHINGI_SJS_2013_G-33-4542311.conllu', 
'ALTHINGI_SJS_2013_G-33-4542313.conllu', 
'ALTHINGI_SJS_2013_G-33-4545749.conllu', 
'ALTHINGI_SJS_2013_G-33-4545750.conllu', 
'ALTHINGI_SJS_2013_G-33-4545751.conllu', 
'ALTHINGI_SJS_2013_G-33-4556342.conllu', 
'ALTHINGI_SJS_2013_G-33-4556344.conllu', 
'ALTHINGI_SJS_2013_G-33-4563267.conllu', 
'ALTHINGI_SJS_2013_G-33-4565680.conllu', 
'ALTHINGI_SJS_2013_G-33-4573848.conllu', 
'ALTHINGI_SJS_2013_G-33-4577317.conllu', 
'ALTHINGI_SJS_2013_G-33-4578072.conllu', 
'ALTHINGI_SJS_2013_G-33-4587994.conllu', 
'ALTHINGI_SJS_2013_G-33-4588733.conllu', 
'ALTHINGI_SJS_2013_G-33-4591505.conllu', 
'ALTHINGI_SJS_2013_G-33-4591520.conllu', 
'ALTHINGI_SJS_2013_G-33-4594976.conllu', 
'ALTHINGI_SJS_2013_G-33-4598594.conllu', 
'ALTHINGI_SJS_2013_G-33-4599290.conllu', 
'ALTHINGI_SJS_2013_G-33-4611638.conllu', 
'ALTHINGI_SJS_2013_G-33-4624358.conllu', 
'ALTHINGI_SJS_2013_G-33-4629754.conllu', 
'ALTHINGI_SJS_2013_G-33-4629755.conllu', 
'ALTHINGI_SJS_2013_G-33-4637963.conllu', 
'ALTHINGI_SJS_2013_G-33-4655541.conllu', 
'ALTHINGI_SJS_2013_G-33-4662791.conllu', 
'ALTHINGI_SJS_2013_G-33-4663510.conllu', 
'ALTHINGI_SJS_2013_G-33-4669991.conllu', 
'ALTHINGI_SJS_2013_G-33-4673510.conllu', 
'ALTHINGI_SJS_2013_G-33-4677109.conllu', 
'ALTHINGI_SJS_2013_G-33-4684293.conllu', 
'ALTHINGI_SJS_2013_G-33-4691401.conllu', 
'ALTHINGI_SJS_2013_G-33-4691402.conllu', 
'ALTHINGI_SJS_2013_G-33-4695027.conllu', 
'ALTHINGI_SJS_2013_G-33-4695028.conllu', 
'ALTHINGI_SJS_2013_G-33-4702186.conllu', 
'ALTHINGI_SJS_2013_G-33-4709262.conllu', 
'ALTHINGI_SJS_2013_G-33-4716305.conllu', 
'ALTHINGI_SJS_2013_G-33-4717034.conllu', 
'ALTHINGI_SJS_2013_G-33-4723511.conllu', 
'ALTHINGI_SJS_2013_G-33-4727109.conllu', 
'ALTHINGI_SJS_2013_G-33-4734200.conllu', 
'ALTHINGI_SJS_2013_G-33-4734201.conllu', 
'ALTHINGI_SJS_2013_G-33-4736548.conllu', 
'ALTHINGI_SJS_2013_G-33-4744812.conllu', 
'ALTHINGI_SJS_2013_G-33-4744814.conllu', 
'ALTHINGI_SJS_2013_G-33-4748288.conllu', 
'ALTHINGI_SJS_2013_G-33-4758755.conllu', 
'ALTHINGI_SJS_2013_G-33-4762171.conllu', 
'ALTHINGI_SJS_2013_G-33-4762172.conllu', 
'ALTHINGI_SJS_2013_G-33-4772703.conllu', 
'ALTHINGI_SJS_2013_G-33-4772704.conllu', 
'ALTHINGI_SJS_2013_G-33-4772705.conllu', 
'ALTHINGI_SJS_2013_G-33-4779889.conllu', 
'ALTHINGI_SJS_2013_G-33-4790594.conllu',
'ALTHINGI_TKG_2011_G-33-4525556.conllu', 
'ALTHINGI_TKG_2011_G-33-4532456.conllu', 
'ALTHINGI_TKG_2011_G-33-4539509.conllu', 
'ALTHINGI_TKG_2011_G-33-4539510.conllu', 
'ALTHINGI_TKG_2011_G-33-4549968.conllu', 
'ALTHINGI_TKG_2011_G-33-4557046.conllu', 
'ALTHINGI_TKG_2011_G-33-4557047.conllu', 
'ALTHINGI_TKG_2011_G-33-4567526.conllu', 
'ALTHINGI_TKG_2011_G-33-4574562.conllu', 
'ALTHINGI_TKG_2011_G-33-4578083.conllu', 
'ALTHINGI_TKG_2011_G-33-4578086.conllu', 
'ALTHINGI_TKG_2011_G-33-4578087.conllu', 
'ALTHINGI_TKG_2011_G-33-4578088.conllu', 
'ALTHINGI_TKG_2011_G-33-4583228.conllu', 
'ALTHINGI_TKG_2011_G-33-4585081.conllu', 
'ALTHINGI_TKG_2011_G-33-4588829.conllu', 
'ALTHINGI_TKG_2011_G-33-4592214.conllu', 
'ALTHINGI_TKG_2011_G-33-4595689.conllu', 
'ALTHINGI_TKG_2011_G-33-4595690.conllu', 
'ALTHINGI_TKG_2011_G-33-4595716.conllu', 
'ALTHINGI_TKG_2011_G-33-4595718.conllu', 
'ALTHINGI_TKG_2011_G-33-4599302.conllu', 
'ALTHINGI_TKG_2011_G-33-4624367.conllu', 
'ALTHINGI_TKG_2011_G-33-4626061.conllu', 
'ALTHINGI_TKG_2011_G-33-4627955.conllu', 
'ALTHINGI_TKG_2011_G-33-4638770.conllu', 
'ALTHINGI_TKG_2011_G-33-4642156.conllu', 
'ALTHINGI_TKG_2011_G-33-4642189.conllu', 
'ALTHINGI_TKG_2011_G-33-4642190.conllu', 
'ALTHINGI_TKG_2011_G-33-4642192.conllu', 
'ALTHINGI_TKG_2011_G-33-4645679.conllu', 
'ALTHINGI_TKG_2011_G-33-4645697.conllu', 
'ALTHINGI_TKG_2011_G-33-4645702.conllu', 
'ALTHINGI_TKG_2011_G-33-4649173.conllu', 
'ALTHINGI_TKG_2011_G-33-4649268.conllu', 
'ALTHINGI_TKG_2011_G-33-4656292.conllu', 
'ALTHINGI_TKG_2011_G-33-4659893.conllu',
'RUV_ESP_2016_G-2-1033281.conllu', 
'RUV_ESP_2016_G-2-1033697.conllu', 
'RUV_ESP_2016_G-2-1033705.conllu', 
'RUV_ESP_2016_G-2-1034237.conllu', 
'RUV_ESP_2016_G-2-1034247.conllu', 
'RUV_ESP_2016_G-2-1034249.conllu', 
'RUV_ESP_2016_G-2-1034251.conllu', 
'RUV_ESP_2016_G-2-1035653.conllu', 
'RUV_ESP_2016_G-2-1035654.conllu', 
'RUV_ESP_2016_G-2-1035661.conllu', 
'RUV_ESP_2016_G-2-1035665.conllu', 
'RUV_ESP_2016_G-2-1036011.conllu', 
'RUV_ESP_2016_G-2-1036163.conllu', 
'RUV_ESP_2016_G-2-1036602.SANITY.conllu', 
'RUV_ESP_2016_G-2-1036604.SANITY.conllu', 
'RUV_ESP_2016_G-2-1036615.SANITY.conllu', 
'RUV_ESP_2016_G-2-1036688.SANITY.conllu', 
'RUV_ESP_2016_G-2-1036692.SANITY.conllu', 
'RUV_ESP_2016_G-2-1036705.SANITY.conllu', 
'RUV_ESP_2016_G-2-1037663.SANITY.conllu', 
'RUV_ESP_2016_G-2-1037669.SANITY.conllu', 
'RUV_ESP_2016_G-2-1037672.SANITY.conllu', 
'RUV_ESP_2016_G-2-1037757.conllu', 
'RUV_ESP_2016_G-2-1038331.conllu', 
'RUV_ESP_2016_G-2-1038371.conllu', 
'RUV_ESP_2016_G-2-1038378.conllu', 
'RUV_ESP_2016_G-2-1039764.SANITY.conllu', 
'RUV_ESP_2016_G-2-1039768.SANITY.conllu', 
'RUV_ESP_2016_G-2-1039771.SANITY.conllu', 
'RUV_ESP_2016_G-2-1039970.SANITY.conllu',
'RUV_TGS_2016_G-2-1032149.SANITY.conllu', 
'RUV_TGS_2016_G-2-1032157.SANITY.conllu', 
'RUV_TGS_2016_G-2-1032177.SANITY.conllu', 
'RUV_TGS_2016_G-2-1032180.SANITY.conllu', 
'RUV_TGS_2016_G-2-1032486.SANITY.conllu', 
'RUV_TGS_2016_G-2-1032490.SANITY.conllu', 
'RUV_TGS_2016_G-2-1032556.SANITY.conllu', 
'RUV_TGS_2016_G-2-1032743.SANITY.conllu', 
'RUV_TGS_2016_G-2-1032745.SANITY.conllu', 
'RUV_TGS_2016_G-2-1032762.SANITY.conllu', 
'RUV_TGS_2016_G-2-1032764.SANITY.conllu', 
'RUV_TGS_2016_G-2-1032790.SANITY.conllu', 
'RUV_TGS_2016_G-2-1032791.SANITY.conllu', 
'RUV_TGS_2016_G-2-1032793.SANITY.conllu', 
'RUV_TGS_2016_G-2-1032802.SANITY.conllu', 
'RUV_TGS_2016_G-2-1032804.SANITY.conllu', 
'RUV_TGS_2016_G-2-1032815.SANITY.conllu', 
'RUV_TGS_2016_G-2-1032828.SANITY.conllu', 
'RUV_TGS_2016_G-2-1032850.SANITY.conllu', 
'RUV_TGS_2016_G-2-1032964.SANITY.conllu', 
'RUV_TGS_2016_G-2-1032966.SANITY.conllu',
'RUV_TGS_2016_G-2-1033023.SANITY.conllu'],

    'test': ['ALTHINGI_BO_2013_G-33-4656263.conllu', 
                'ALTHINGI_BO_2013_G-33-4666392.conllu', 
                'ALTHINGI_BO_2014_G-33-4608528.conllu', 
                'ALTHINGI_BO_2014_G-33-4507277.conllu', 
                'ALTHINGI_BO_2014_G-33-4521344.conllu',
                'ALTHINGI_BO_2014_G-33-4569636.conllu', 
                'ALTHINGI_BO_2014_G-33-4804825.conllu', 
                'ALTHINGI_BO_2015_G-33-4521247.conllu', 
                'ALTHINGI_BO_2015_G-33-4523895.conllu', 
                'ALTHINGI_BO_2015_G-33-4549104.conllu', 
                'ALTHINGI_BO_2015_G-33-4604326.conllu', 
                'ALTHINGI_HHG_2013_G-33-4492074.conllu', 
                'ALTHINGI_HHG_2013_G-33-4497471.conllu', 
                'ALTHINGI_HHG_2013_G-33-4500256.conllu', 
                'ALTHINGI_HHG_2013_G-33-4542329.conllu', 
                'ALTHINGI_HHG_2013_G-33-4570267.conllu', 
                'ALTHINGI_SJS_2013_G-33-4493268.conllu', 
                'ALTHINGI_SJS_2013_G-33-4496708.conllu', 
                'ALTHINGI_SJS_2013_G-33-4496709.conllu', 
                'ALTHINGI_SJS_2013_G-33-4503791.conllu', 
                'ALTHINGI_SJS_2013_G-33-4517845.conllu', 
                'ALTHINGI_TKG_2011_G-33-4497467.conllu', 
                'ALTHINGI_TKG_2011_G-33-4501008.conllu', 
                'ALTHINGI_TKG_2011_G-33-4511514.conllu', 
                'ALTHINGI_TKG_2011_G-33-4522153.conllu', 
                'RUV_ESP_2016_G-2-1031892.conllu', 
                'RUV_ESP_2016_G-2-1031957.conllu', 
                'RUV_ESP_2016_G-2-1031964.conllu', 
                'RUV_ESP_2016_G-2-1033096.conllu', 
                'RUV_ESP_2016_G-2-1033155.conllu', 
                'RUV_TGS_2016_G-2-1031601.SANITY.conllu', 
                'RUV_TGS_2016_G-2-1031626.SANITY.conllu', 
                'RUV_TGS_2016_G-2-1031631.SANITY.conllu', 
                'RUV_TGS_2016_G-2-1031931.SANITY.conllu',],

    'dev': ['ALTHINGI_BO_2013_G-33-4727062.conllu', 
            'ALTHINGI_BO_2013_G-33-4743644.conllu', 
            'ALTHINGI_BO_2014_G-33-4616309.conllu', 
            'ALTHINGI_BO_2014_G-33-4587316.conllu', 
            'ALTHINGI_BO_2014_G-33-4592176.conllu', 
            'ALTHINGI_BO_2014_G-33-4598544.conllu', 
            'ALTHINGI_BO_2014_G-33-4723471.conllu', 
            'ALTHINGI_BO_2015_G-33-4576665.conllu', 
            'ALTHINGI_BO_2015_G-33-4583710.conllu', 
            'ALTHINGI_BO_2015_G-33-4594314.conllu', 
            'ALTHINGI_BO_2015_G-33-4608533.conllu', 
            'ALTHINGI_HHG_2013_G-33-4525575.conllu', 
            'ALTHINGI_HHG_2013_G-33-4528305.conllu', 
            'ALTHINGI_HHG_2013_G-33-4534200.conllu', 
            'ALTHINGI_HHG_2013_G-33-4542330.conllu', 
            'ALTHINGI_HHG_2013_G-33-4577290.conllu', 
            'ALTHINGI_SJS_2013_G-33-4496710.conllu', 
            'ALTHINGI_SJS_2013_G-33-4500290.conllu',
            'ALTHINGI_SJS_2013_G-33-4500291.conllu', 
            'ALTHINGI_SJS_2013_G-33-4510804.conllu', 
            'ALTHINGI_SJS_2013_G-33-4517846.conllu', 
            'ALTHINGI_TKG_2011_G-33-4515035.conllu', 
            'ALTHINGI_TKG_2011_G-33-4522123.conllu', 
            'ALTHINGI_TKG_2011_G-33-4522147.conllu', 
            'ALTHINGI_TKG_2011_G-33-4522155.conllu', 
            'RUV_ESP_2016_G-2-1031977.conllu',
            'RUV_ESP_2016_G-2-1032281.conllu', 
            'RUV_ESP_2016_G-2-1032928.conllu', 
            'RUV_ESP_2016_G-2-1033101.conllu', 
            'RUV_ESP_2016_G-2-1033175.conllu', 
            'RUV_TGS_2016_G-2-1031640.SANITY.conllu', 
            'RUV_TGS_2016_G-2-1031735.SANITY.conllu', 
            'RUV_TGS_2016_G-2-1031922.SANITY.conllu', 
            'RUV_TGS_2016_G-2-1032146.SANITY.conllu']}

PREFIXES = ['dev', 'test', 'train']

# TEST_PATH = '../../CoNLLU'
TEST_PATH = sys.argv[1]
ERROR_SENTS = get_error_sents(TEST_PATH)

print(f'\nNo. of non-valid sentencens:\t{len(ERROR_SENTS)}\n')

for prefix in PREFIXES:
    total_sentences = 0
    output_file = f'is_modern-ud-{prefix}.conllu'
    print(f'Writing to file: {output_file}')
    with open(output_file, 'a+') as f, open('error_sents.conllu', 'a+') as err_f:
        for file in SPLITS[prefix]:
            
            file_sentences = 0
            
            #file += '.conllu'
            print(f'\t{file}')
            conll = pyconll.iter_from_file(os.path.join(TEST_PATH, file))
            for sentence in conll:
                file_sentences +=1
                total_sentences +=1
                # if sentence.id in ERROR_SENTS:
                #     err_f.write(sentence.conll())
                #     err_f.write('\n\n')
                # else:
                output_conll = fix_sent_ids(sentence.conll(), file_sentences, total_sentences)
                f.write(output_conll)
                f.write('\n\n')

                
